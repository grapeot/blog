Title: 音频碎碎念（⑨）—— D类放大器
Date: 2022-12-29 19:00
Category: Life
Tags: Sound Engineering, Chinese
Slug: sound-engineering-9-class-d-amp


---

本文是《音频碎碎念系列》系列的一部分：

* [音频碎碎念（一）—— HiFi科学派](/audio-1.html)
* [音频碎碎念（二）—— 响度的玄学](/audio-2.html)
* [音频碎碎念（三）—— 频率的玄学](/audio-3.html)
* [音频碎碎念（四）—— 线材的玄学](/audio-4.html)
* [音频碎碎念（五）—— 听音环境](/audio-5.html)
* [音频碎碎念（六）—— 模电](/audio-6.html)
* [音频碎碎念（七）—— 放大器](/audio-7.html)
* [音频碎碎念（八）—— 放大器输出级](/audio-8.html)
* 音频碎碎念（⑨）—— D类放大器（本文）
* [音频碎碎念（十）—— 地狱听音环境实操](/audio-10.html)

---

今日HiFi玄学：今天学习了D类放大器的设计，感觉实在是太精巧了，非常兴奋。也终于懂了HiFi电源插座在什么情况下不是玄学，什么情况下是玄学了。分享一些感想。

1. 什么是D类放大器：和A/B/H/G类放大器完全不同，D类放大器是一种利用数字电路放大的放大器（输出级）。它的输入是原始的音频信号和一个参考波，比如一个500kHz，在-2V和+2V之间直线振荡的三角波。首先有一个数电里面的比较器比较这两个信号，如果音频信号大于三角波，就输出+2V，反之则输出-2V。这样这个音频信号就被调制成了一个方波。这个方波的占空比就是这个音频信号相对于4V的幅度。下面输出级只要放大这个方波就好了，因为只有高低电平两种状态，所以电路特别简单，概念上就是一个开关。比如驱动电路是一个+/-40V的电源，这个开关看到高电平就接通+40V，低电平就接通-40V。这样这个幅度为4V的输入方波就变成了一个幅度80V的方波，放大了20倍。这个输出方波在经过一个低通滤波器（比如电感或者LC电路）以后就可以直接用来驱动音箱了。因为输出级就是个开关加电感，所以极其高效（现代D级功放可以做到95%效率），发热极小。发热小+数电组件就意味着很容易做成集成电路，体积极小，大大拓展了应用范围。
2. 但反直觉的是，功放可能是消费电子领域最后数字化的组件。D级功放直到1990年代才开始兴起。这主要是它实在是太难做了。它主要有以下几个独特难点：

    * 对驱动电压非常敏感。比如上面的例子里，40V的驱动电压要是某个时间变成41V了，这个时候声音就会突然变响，造成增益随着时间变化，也就是失真。D类放大器的Power Supply Rejection Ratio （PSRR）比其他类别要小很多，有的设计甚至是0。一种解决方法是引入负反馈，把驱动电压也作为输入引入调制器（比如Sigma Delta调制器）。但仍然很难把PSRR提升到模拟电路的水平。
    * Bus pumping。D类放大器的两大特点：开关调制和低通滤波直接造成了一个后果叫bus pumping。比如前一个时刻开关打在驱动电源的正极，电流是从正极流向地线。下一个时刻开关切换到了负极。但因为低通滤波器是个电感，所以电流不会立刻变化，还是从地线流向负极。这就会对驱动电源造成冲击，在某些电源上会造成电压波动，进而造成增益变化，也就是失真。同时音箱，线缆等组件也有类似电感的阻抗，会阻碍电流的剧烈变化，也会造成失真。而且像以前提到的，音箱的阻抗是随着频率变化的，多个因素交织在一起让整个问题更加复杂。
    * 负反馈：前面提到了很多次，失真其实不可怕，只要有一个负反馈机制，其实可以把失真控制在一个很小的范围。但D类放大器一个非常大的问题是很难做负反馈。这主要是因为延时引起的。调制的各种数电组件依赖于时钟，有反应时间。低通滤波器因为会阻碍电流的剧烈变化，也有反应时间。因此输出信号并不像模电放大器一样反映这一时刻输入对应的状态，而是反应一个甚至很多个时钟周期以前的状态。就好像你控制暖气开关来让屋子稳定在20度，但只能看到5分钟前的温度，就很容易调过了一会冷一会热。类似的，用这个有延时的输出去指导放大过程也很容易造成整个系统失稳振荡。
    * 电磁干扰：因为放大器的运转依赖于一个开关高频开关，这本身会发射大量的电磁波，对紧邻的模电电路造成巨大的干扰。所以D类放大器的电磁屏蔽要花很多精力做好。

3. 相应的，D类放大器也有自己的独特优势。除了高能效以外，还有一个非常关键的优势是可以引入DSP进行非常复杂的处理，比如方波的调制可以不用上面说的简单的比较器来做，而是可以用一个微处理器做，引入各种复杂算法。最极端的是SONY有个旗舰音箱SA-Z1，里面的放大器先用FPGA实时对音频做分类，把器乐人声等等全部分出来，然后分开做不同的处理，上采样，增强，最后再合并调制成方波。可以说把声音P得妈的都不认识了。
4. D类放大器一个意料之外，情理之中的拓展应用是直流稳压电源——开关电源。它也是用一个开关控制通断，交流电整流滤波以后生成一个方波，然后再变压滤波之后变成了一个直流电压。它也有小体积，高能效，但是电磁辐射巨大的问题。